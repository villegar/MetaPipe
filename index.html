<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A High-Performance Computing Pipeline for QTL Mapping of Large Ionomic 
           and Metabolomic Datasets • MetaPipe</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="A High-Performance Computing Pipeline for QTL Mapping of Large Ionomic 
           and Metabolomic Datasets">
<meta property="og:description" content="Pipeline for Quantitative Trait Locus (QTL) mapping of large 
    ionomic and metabolomic datasets. It uses a High-Performance Computing 
    (HPC) approach to speed up the computations performed.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">MetaPipe</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/assess-normality.html">Assess Normality</a>
    </li>
    <li>
      <a href="articles/load-raw-data.html">Load raw data</a>
    </li>
    <li>
      <a href="articles/replace-missing-data.html">Replace Missing Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/villegar/MetaPipe/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="metapipe-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#metapipe-" class="anchor"></a>MetaPipe <img src="https://raw.githubusercontent.com/villegar/MetaPipe/master/inst/images/metapipe.png" alt="logo" align="right" height="200px/">
</h1></div>
<!-- badges: start -->
<!-- [![Build Status](https://travis-ci.com/villegar/MetaPipe.svg?branch=master)](https://travis-ci.com/villegar/MetaPipe) -->
<!-- [![](https://travis-ci.com/villegar/MetaPipe.svg?branch=master)](https://travis-ci.com/villegar/MetaPipe) -->

<p>MetaPipe: A High-Performance Computing Pipeline for QTL Mapping of Large Ionomic and Metabolomic Datasets</p>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>The goal of MetaPipe is to provide an easy to use and powerful tool capable of performing QTL mapping analyses. <!-- on metabolomics data. --></p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of MetaPipe from <a href="https://cran.r-project.org/package=MetaPipe">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"MetaPipe"</span><span class="op">)</span></code></pre></div>
<p>And the development version from <a href="https://github.com/villegar/MetaPipe">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages(c("hexSticker", "kableExtra", "qpdf", "remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"villegar/MetaPipe"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<!-- This is a basic example which shows you how to solve a common problem: -->
<!-- You should start by loading `MetaPipe` on your session. -->
<!-- ```{r example} -->
<!-- library(MetaPipe) -->
<!-- ``` -->
<div id="load-raw-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-raw-data" class="anchor"></a>Load raw data</h3>
<p>For details about the data structure and extended documentation, see the vignette <a href="https://villegar.github.io/MetaPipe/articles/load-raw-data">Load Raw Data</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html">vignette</a></span><span class="op">(</span><span class="st">"load-raw-data"</span>, package <span class="op">=</span> <span class="st">"MetaPipe"</span><span class="op">)</span></code></pre></div>
<div id="function-call" class="section level4">
<h4 class="hasAnchor">
<a href="#function-call" class="anchor"></a>Function call</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">MetaPipe</span><span class="fu">::</span><span class="fu"><a href="reference/load_raw.html">load_raw</a></span><span class="op">(</span>raw_data_filename <span class="op">=</span> <span class="st">"FILE.CSV"</span>, excluded_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>where <code>raw_data_filename</code> is the filename containing the raw data, both absolute and relative paths are accepted. Next, the argument <code>excluded_columns</code> is a vector containing the indices of the properties, e.g. <code><a href="https://rdrr.io/r/base/c.html">c(2, 3, ..., M)</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># F1 Seedling Ionomics dataset</span>
<span class="va">ionomics_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, 
                             <span class="st">"ionomics.csv"</span>, 
                             package <span class="op">=</span> <span class="st">"MetaPipe"</span>, 
                             mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">ionomics</span> <span class="op">&lt;-</span> <span class="fu">MetaPipe</span><span class="fu">::</span><span class="fu"><a href="reference/load_raw.html">load_raw</a></span><span class="op">(</span><span class="va">ionomics_path</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">ionomics</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">ID</th>
<th align="right">SampleWeight</th>
<th align="right">Ca44</th>
<th align="right">K39</th>
<th align="right">P31</th>
<th align="right">Li7</th>
<th align="right">B11</th>
<th align="right">Na23</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">E_199</td>
<td align="right">79</td>
<td align="right">32675.79</td>
<td align="right">6051.023</td>
<td align="right">2679.338</td>
<td align="right">0.1159068</td>
<td align="right">23.32975</td>
<td align="right">9.372606</td>
</tr>
<tr class="even">
<td align="left">E_209</td>
<td align="right">81</td>
<td align="right">28467.95</td>
<td align="right">5642.651</td>
<td align="right">2075.403</td>
<td align="right">0.0104801</td>
<td align="right">27.31206</td>
<td align="right">8.787553</td>
</tr>
<tr class="odd">
<td align="left">E_035</td>
<td align="right">81</td>
<td align="right">27901.35</td>
<td align="right">7357.856</td>
<td align="right">2632.343</td>
<td align="right">0.0561879</td>
<td align="right">16.87480</td>
<td align="right">14.369062</td>
</tr>
<tr class="even">
<td align="left">E_197</td>
<td align="right">79</td>
<td align="right">27855.36</td>
<td align="right">5225.275</td>
<td align="right">1761.725</td>
<td align="right">0.0104453</td>
<td align="right">25.34740</td>
<td align="right">11.009597</td>
</tr>
<tr class="odd">
<td align="left">E_016</td>
<td align="right">79</td>
<td align="right">27377.40</td>
<td align="right">6141.001</td>
<td align="right">2145.715</td>
<td align="right">0.0172996</td>
<td align="right">24.64500</td>
<td align="right">6.999958</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="replace-missing-data" class="section level3">
<h3 class="hasAnchor">
<a href="#replace-missing-data" class="anchor"></a>Replace missing data</h3>
<p>For extended documentation, see the vignette <a href="https://villegar.github.io/MetaPipe/articles/replace-missing-data">Replace Missing Data</a>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html">vignette</a></span><span class="op">(</span><span class="st">"replace-missing-data"</span>, package <span class="op">=</span> <span class="st">"MetaPipe"</span><span class="op">)</span></code></pre></div>
<div id="function-call-1" class="section level4">
<h4 class="hasAnchor">
<a href="#function-call-1" class="anchor"></a>Function call</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">MetaPipe</span><span class="fu">::</span><span class="fu"><a href="reference/replace_missing.html">replace_missing</a></span><span class="op">(</span>raw_data <span class="op">=</span> <span class="va">example_data</span>, 
                          excluded_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, 
                          <span class="co"># Optional</span>
                          out_prefix <span class="op">=</span> <span class="st">"metapipe"</span>, 
                          prop_na <span class="op">=</span> <span class="fl">0.5</span>, 
                          replace_na <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>where <code>raw_data</code> is a data frame containing the raw data, as described in <a href="#load-raw-data">Load Raw Data</a> and <code>excluded_columns</code> is a vector containing the indices of the properties, e.g. <code><a href="https://rdrr.io/r/base/c.html">c(2, 3, ..., M)</a></code>. The other arguments are optional, <code>out_prefix</code> is the prefix for output files, <code>prop_na</code> is the proportion of NA values (used to drop traits), and <code>replace_na</code> is a logical flag to indicate whether or not <code>NA</code>s should be replace by half of the minimum value within each variable.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># F1 Seedling Ionomics dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">ionomics</span><span class="op">)</span> <span class="co"># Includes some missing data</span>
<span class="va">ionomics_rev</span> <span class="op">&lt;-</span> <span class="fu">MetaPipe</span><span class="fu">::</span><span class="fu"><a href="reference/replace_missing.html">replace_missing</a></span><span class="op">(</span><span class="va">ionomics</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">ionomics_rev</span> <span class="op">&lt;-</span> <span class="fu">MetaPipe</span><span class="fu">::</span><span class="fu"><a href="reference/replace_missing.html">replace_missing</a></span><span class="op">(</span><span class="va">ionomics</span>, 
                                          excluded_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, 
                                          prop_na <span class="op">=</span>  <span class="fl">0.025</span><span class="op">)</span>
<span class="co">#&gt; The following trait was dropped because it has 2.5% or more missing values: </span>
<span class="co">#&gt;  - Se78</span>
<span class="va">ionomics_rev</span> <span class="op">&lt;-</span> <span class="fu">MetaPipe</span><span class="fu">::</span><span class="fu"><a href="reference/replace_missing.html">replace_missing</a></span><span class="op">(</span><span class="va">ionomics</span>, 
                                          excluded_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
                                          replace_na <span class="op">=</span>  <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">ionomics_rev</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">ID</th>
<th align="right">SampleWeight</th>
<th align="right">Ca44</th>
<th align="right">K39</th>
<th align="right">P31</th>
<th align="right">Li7</th>
<th align="right">B11</th>
<th align="right">Na23</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">E_001</td>
<td align="right">79</td>
<td align="right">15894.22</td>
<td align="right">5888.311</td>
<td align="right">1743.118</td>
<td align="right">0.0128699</td>
<td align="right">18.66673</td>
<td align="right">6.970224</td>
</tr>
<tr class="even">
<td align="left">E_002</td>
<td align="right">93</td>
<td align="right">13155.45</td>
<td align="right">7013.400</td>
<td align="right">2244.684</td>
<td align="right">0.0119316</td>
<td align="right">14.47693</td>
<td align="right">5.866392</td>
</tr>
<tr class="odd">
<td align="left">E_004</td>
<td align="right">97</td>
<td align="right">14182.51</td>
<td align="right">7966.273</td>
<td align="right">2311.057</td>
<td align="right">0.0212316</td>
<td align="right">14.71313</td>
<td align="right">10.251955</td>
</tr>
<tr class="even">
<td align="left">E_005</td>
<td align="right">82</td>
<td align="right">22550.82</td>
<td align="right">7514.089</td>
<td align="right">2315.675</td>
<td align="right">0.0233063</td>
<td align="right">20.10630</td>
<td align="right">11.773697</td>
</tr>
<tr class="odd">
<td align="left">E_006</td>
<td align="right">99</td>
<td align="right">15982.76</td>
<td align="right">7608.464</td>
<td align="right">1995.193</td>
<td align="right">0.0588128</td>
<td align="right">12.97801</td>
<td align="right">11.043837</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="assess-normality" class="section level3">
<h3 class="hasAnchor">
<a href="#assess-normality" class="anchor"></a>Assess normality</h3>
<p>For extended documentation, see the vignette <a href="https://villegar.github.io/MetaPipe/articles/assess-normality">Assess Normality</a>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html">vignette</a></span><span class="op">(</span><span class="st">"assess-normality"</span>, package <span class="op">=</span> <span class="st">"MetaPipe"</span><span class="op">)</span></code></pre></div>
<p><code>MetaPipe</code> assesses the normality of variables (traits) by performing a Shapiro-Wilk test on the raw data (see <a href="https://villegar.github.io/MetaPipe/articles/load-raw-data.html">Load Raw Data</a> and <a href="https://villegar.github.io/MetaPipe/articles/replace-missing-data.html">Replace Missing Data</a>. Based on whether or not the data approximates a normal distribution, an array of transformations will be computed, and the normality assessed one more time.</p>
<div id="function-call-2" class="section level4">
<h4 class="hasAnchor">
<a href="#function-call-2" class="anchor"></a>Function call</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">MetaPipe</span><span class="fu">::</span><span class="fu"><a href="reference/assess_normality.html">assess_normality</a></span><span class="op">(</span>raw_data <span class="op">=</span> <span class="va">raw_data</span>, 
                           excluded_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="va">...</span>, <span class="va">M</span><span class="op">)</span>, 
                           <span class="co"># Optional</span>
                           cpus <span class="op">=</span> <span class="fl">1</span>, 
                           out_prefix <span class="op">=</span> <span class="st">"metapipe"</span>, 
                           plots_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>, 
                           transf_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span>,
                           alpha <span class="op">=</span> <span class="fl">0.05</span>,
                           pareto_scaling <span class="op">=</span> <span class="cn">FALSE</span>,
                           show_stats <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>where <code>raw_data</code> is a data frame containing the raw data, as described in <a href="https://villegar.github.io/MetaPipe/articles/load-raw-data.html">Load Raw Data</a> and <code>excluded_columns</code> is a vector containing the indices of the properties, e.g. <code><a href="https://rdrr.io/r/base/c.html">c(2, 3, ..., M)</a></code>. The other arguments are optional, <code>cpus</code> is the number of cores to use, in other words, the number of concurrent traits to process, <code>out_prefix</code> is the prefix for output files, <code>plots_dir</code> is the output directory where the plots will be stored, <code>transf_vals</code> is a vector containing the transformation values to be used when transforming the original data, <code>alpha</code> is the significance level for the <em>Wilk-Shapiro</em> tests, <code>pareto_scaling</code> is a boolean flag to indicate whether or not to scale the traits to the same scale, and <code>show_stats</code> is a boolean flag to show or hide some general statistics of the normalisation process.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># F1 Seedling Ionomics dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">ionomics</span><span class="op">)</span> <span class="co"># Includes some missing data</span>
<span class="va">ionomics_rev</span> <span class="op">&lt;-</span> <span class="fu">MetaPipe</span><span class="fu">::</span><span class="fu"><a href="reference/replace_missing.html">replace_missing</a></span><span class="op">(</span><span class="va">ionomics</span>, 
                                          excluded_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
                                          replace_na <span class="op">=</span>  <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">ionomics_normalised</span> <span class="op">&lt;-</span> 
  <span class="fu">MetaPipe</span><span class="fu">::</span><span class="fu"><a href="reference/assess_normality.html">assess_normality</a></span><span class="op">(</span><span class="va">ionomics_rev</span>,
                             excluded_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
                             transf_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
                             out_prefix <span class="op">=</span> <span class="st">"README-ionomics"</span>,
                             plots_dir <span class="op">=</span> <span class="st">"man/figures/"</span>,
                             pareto_scaling <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Total traits (excluding all NAs traits):     21</span>
<span class="co">#&gt; Normal traits (without transformation):      2</span>
<span class="co">#&gt; Normal traits (transformed):                 4</span>
<span class="co">#&gt; Total normal traits:                         6</span>
<span class="co">#&gt; Total skewed traits:                         15</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Transformations summary:</span>
<span class="co">#&gt;  f(x)      Value     # traits  </span>
<span class="co">#&gt;  log       2         3         </span>
<span class="co">#&gt;  root      e         1</span>

<span class="co"># Extract normalised features</span>
<span class="va">ionomics_norm</span> <span class="op">&lt;-</span> <span class="va">ionomics_normalised</span><span class="op">$</span><span class="va">norm</span>
<span class="va">ionomics_skew</span> <span class="op">&lt;-</span> <span class="va">ionomics_normalised</span><span class="op">$</span><span class="va">skew</span></code></pre></div>
<p>The function call to <code><a href="reference/assess_normality.html">MetaPipe::assess_normality</a></code> will print a summary of the transformations performed (if any), as well as an overview of the number of traits that should be considered <em>normal</em> and <em>skewed</em>. Next, we can preview some of the partial output of the normality assessment process:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Normal traits</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">ionomics_norm</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span><span class="op">)</span> </code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">ID</th>
<th align="right">Ca44</th>
<th align="right">B11</th>
<th align="right">Na23</th>
<th align="right">Mg26</th>
<th align="right">Rb85</th>
<th align="right">Sr88</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">E_001</td>
<td align="right">15894.22</td>
<td align="right">4.222397</td>
<td align="right">2.042740</td>
<td align="right">10.77021</td>
<td align="right">1.555742</td>
<td align="right">7.347059</td>
</tr>
<tr class="even">
<td align="left">E_002</td>
<td align="right">13155.45</td>
<td align="right">3.855684</td>
<td align="right">1.917202</td>
<td align="right">10.54095</td>
<td align="right">2.058711</td>
<td align="right">6.890243</td>
</tr>
<tr class="odd">
<td align="left">E_004</td>
<td align="right">14182.51</td>
<td align="right">3.879033</td>
<td align="right">2.354263</td>
<td align="right">10.51931</td>
<td align="right">2.198422</td>
<td align="right">9.025915</td>
</tr>
<tr class="even">
<td align="left">E_005</td>
<td align="right">22550.82</td>
<td align="right">4.329576</td>
<td align="right">2.477233</td>
<td align="right">11.13450</td>
<td align="right">1.791578</td>
<td align="right">15.292360</td>
</tr>
<tr class="odd">
<td align="left">E_006</td>
<td align="right">15982.76</td>
<td align="right">3.697997</td>
<td align="right">2.419593</td>
<td align="right">11.72734</td>
<td align="right">2.229866</td>
<td align="right">13.901449</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Skewed traits (partial output)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">ionomics_skew</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">ID</th>
<th align="right">K39</th>
<th align="right">P31</th>
<th align="right">Li7</th>
<th align="right">Al27</th>
<th align="right">S34</th>
<th align="right">Fe54</th>
<th align="right">Mn55</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">E_001</td>
<td align="right">5888.311</td>
<td align="right">1743.118</td>
<td align="right">0.0128699</td>
<td align="right">3.845879</td>
<td align="right">1152.944</td>
<td align="right">27.59340</td>
<td align="right">54.53991</td>
</tr>
<tr class="even">
<td align="left">E_002</td>
<td align="right">7013.400</td>
<td align="right">2244.684</td>
<td align="right">0.0119316</td>
<td align="right">5.825639</td>
<td align="right">1600.442</td>
<td align="right">35.49159</td>
<td align="right">52.57114</td>
</tr>
<tr class="odd">
<td align="left">E_004</td>
<td align="right">7966.273</td>
<td align="right">2311.057</td>
<td align="right">0.0212316</td>
<td align="right">8.036047</td>
<td align="right">1039.098</td>
<td align="right">39.13434</td>
<td align="right">36.66475</td>
</tr>
<tr class="even">
<td align="left">E_005</td>
<td align="right">7514.089</td>
<td align="right">2315.675</td>
<td align="right">0.0233063</td>
<td align="right">9.482051</td>
<td align="right">1091.607</td>
<td align="right">40.22041</td>
<td align="right">43.24368</td>
</tr>
<tr class="odd">
<td align="left">E_006</td>
<td align="right">7608.464</td>
<td align="right">1995.193</td>
<td align="right">0.0588128</td>
<td align="right">29.329605</td>
<td align="right">1096.871</td>
<td align="right">75.23614</td>
<td align="right">53.64705</td>
</tr>
</tbody>
</table>
<p>Among the transformed traits, we have <code>B11</code> and <code>Na23</code>. Both of which seem to be skewed, but after a simple transformation, can be classify as normalised traits.</p>
<p><img src="reference/figures/HIST_5_LOG_2_B11.png" width="45%"><img src="reference/figures/HIST_6_ROOT_e_Na23.png" width="45%"></p>
</div>
</div>
<div id="qtl-mapping" class="section level3">
<h3 class="hasAnchor">
<a href="#qtl-mapping" class="anchor"></a>QTL mapping</h3>
<div id="scan-one-qtl-mapping" class="section level4">
<h4 class="hasAnchor">
<a href="#scan-one-qtl-mapping" class="anchor"></a>Scan one QTL mapping</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>qtl_scone &lt;-<span class="st"> </span><span class="cf">function</span>(x_data, <span class="dt">cpus =</span> <span class="dv">1</span>, ...)</span></code></pre></div>
<!-- #### Function call -->
<p>where <code>x_data</code></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># F1 Seedling Ionomics dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">father_riparia</span><span class="op">)</span> <span class="co"># Genetic map</span>
<span class="co"># Load cross file with genetic map and raw data for normal traits</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">MetaPipe</span><span class="fu">::</span><span class="fu"><a href="reference/read.cross.html">read.cross</a></span><span class="op">(</span><span class="va">father_riparia</span>, 
                          <span class="va">ionomics_norm</span>,
                          genotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"nn"</span>, <span class="st">"np"</span>, <span class="st">"--"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  --Read the following data:</span>
<span class="co">#&gt;   166  individuals</span>
<span class="co">#&gt;   1115  markers</span>
<span class="co">#&gt;   7  phenotypes</span>
<span class="co">#&gt; Warning in summary.cross(cross): Some markers at the same position on chr</span>
<span class="co">#&gt; 1,4,5,7,8,9,10,12,14,15,16,17; use jittermap().</span>
<span class="co">#&gt;  --Cross type: f2</span>
                          
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">qtl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qtl/man/jittermap.html">jittermap</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">qtl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qtl/man/calc.genoprob.html">calc.genoprob</a></span><span class="op">(</span><span class="va">x</span>, step <span class="op">=</span> <span class="fl">1</span>, error.prob <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">x_scone</span> <span class="op">&lt;-</span> <span class="fu">MetaPipe</span><span class="fu">::</span><span class="fu"><a href="reference/qtl_scone.html">qtl_scone</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, model <span class="op">=</span> <span class="st">"normal"</span>, method <span class="op">=</span> <span class="st">"hk"</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/villegar/MetaPipe/">https://​github.com/​villegar/​MetaPipe/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/villegar/MetaPipe/issues/">https://​github.com/​villegar/​MetaPipe/​issues/​</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Roberto Villegas-Diaz <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5036-8661" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Dilmini Alahakoon <br><small class="roles"> Author </small>  </li>
<li>Anne Fennell <br><small class="roles"> Author, thesis advisor </small> <a href="https://orcid.org/0000-0002-4234-6419" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=MetaPipe"><img src="https://www.r-pkg.org/badges/version/MetaPipe?color=black"></a></li>
<li><a href="https://github.com/villegar/MetaPipe"><img src="https://img.shields.io/badge/devel%20version-0.1.0-yellow.svg"></a></li>
<li><a href="https://codecov.io/gh/villegar/MetaPipe"><img src="https://codecov.io/gh/villegar/MetaPipe/branch/master/graph/badge.svg"></a></li>
<li><a href="https://github.com/villegar/MetaPipe//actions"><img src="https://github.com/villegar/MetaPipe//workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Roberto Villegas-Diaz, Dilmini Alahakoon, Anne Fennell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
